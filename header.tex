%!TEX root = desc.tex
\newif\ifdraft\drafttrue

\documentclass[11pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage[sort&compress,numbers]{natbib}
% amsthm needs to go before newtx for compatability reasons
\usepackage{amsthm,amssymb}
\usepackage{newtx}
\usepackage{microtype}
\frenchspacing

\usepackage{mathpartir}
\usepackage{stmaryrd}
\usepackage{mathtools}

\usepackage{suffix}
\usepackage{xparse}

%\usepackage{pslatex}
%\usepackage{fullpage}
\usepackage{xspace}
\usepackage{verbatim}
\usepackage{enumitem}
%\usepackage{wrapfig}
%\usepackage{tgpagella}
\usepackage{url}
\usepackage{breakurl}
\usepackage[hidelinks,bookmarks=true]{hyperref}
\usepackage{graphicx}
\usepackage{subfig}
\usepackage{titlesec}
%\usepackage{fancyhdr}
\usepackage{float}
\usepackage[font=small]{caption}
\usepackage[table,dvipsnames]{xcolor}

\setlist[itemize,enumerate]{
  itemsep=0pt,
  topsep=1ex,
}

% ===== Title and section header formatting ====
\makeatletter
\def\@author{}
\def\author#1#2{\expandafter\def\expandafter\@author\expandafter{\@author{#1}{#2}}}
\def\typeset@authors#1#2#3\_nil{%
  \begin{tabular}[t]{c}#1\end{tabular}\\
  {\large #2}
  \ifx\relax#3\relax\else\and\typeset@authors#3\_nil\fi%
}
\def\maketitle{
  \newpage%
  \vbox to 1.2in{
    \centering
    \vspace*{\fill}
      {\LARGE\bfseries\@title\par}
      \vskip 0.75em
      {\Large\begin{tabular}[t]{c}\expandafter\typeset@authors\@author\_nil\end{tabular}\par}
    \vspace*{\fill}
  }
%  \begin{titlepage}
%    \centering
%    \vspace*{\fill}
%      {\huge\@title\par}
%      \vskip 2em
%      {\Large\begin{tabular}[t]{c}\expandafter\typeset@authors\@author\_nil\end{tabular}\par}
%    \vspace*{\fill}
%  \end{titlepage}
}
%\def\typeset@affils#1#2#3\_nil{\textsuperscript{#1}#2\ifx\relax#3\relax\else\and\typeset@affils#3\_nil\fi}
%\newcommand{\affils}[1]{\def\@affils{#1}}
%\def\maketitle{
%  \newpage%
%  \vbox to 0.9in{
%    \centering
%    \vspace*{\fill}
%      {\Large\bfseries\@title\par}
%      \vskip 1ex
%      {\normalsize\begin{tabular}[t]{c}\@author\end{tabular}\par}
%      \ifx\relax\@affils\relax\else
%        \vskip 0.5ex
%        {\small\begin{tabular}[t]{c}\expandafter\typeset@affils\@affils\_nil\end{tabular}\par}
%      \fi
%    \vspace*{\fill}
%  }
%}
\makeatother

\titlespacing*{\section}{0pt}{*2.5}{*2}
\titlespacing*{\subsection}{0pt}{*2}{*1}
%\titlespacing*{\subsubsection}{0pt}{*0.75}{*0.5}
\titleformat{\paragraph}[runin]{\bfseries}{}{0pt}{}[.]
\titlespacing{\paragraph}{0pt}{*1.5}{*1}
\titleformat{\subparagraph}[runin]{\bfseries}{}{0pt}{}
\titlespacing{\subparagraph}{0pt}{*1}{*1}

\makeatletter
\newcounter{ex@cntr}
\newenvironment{example}[1]{%
  \par\vspace{1.5ex plus 0.5ex minus 0.5ex}%
  \noindent%
  \addtocounter{ex@cntr}{1}%
  \textbf{Example \theex@cntr: #1.}\hspace{1ex plus 0.5ex minus 0.5ex}\ignorespaces%
}{\par\medskip}
\makeatother

%\renewcommand{\textfraction}{0.01}
%\setcounter{topnumber}{100}
%\setcounter{dbltopnumber}{100}
%\setcounter{totalnumber}{100}
%\renewcommand{\topfraction}{.9}
%\renewcommand{\floatpagefraction}{.9}
%\renewcommand{\dbltopfraction}{.9}
%\renewcommand{\dblfloatpagefraction}{.9}
%
%\newcounter{cnt}

%\setlength{\abovecaptionskip}{0in}
%\setlength{\belowcaptionskip}{0in}


%make latex layout figures better
%\renewcommand{\topfraction}{0.85}
%\renewcommand{\textfraction}{0.09}
%\renewcommand{\floatpagefraction}{0.85}


\date{}

%\newsavebox{\mylistingbox}
%
%\pagestyle{fancy}
%\fancyhead{}
%\fancyhf{}
%\renewcommand{\headrulewidth}{0pt}
%\setcounter{page}{1}
%%\usepackage{epstopdf}

% Notes
\usepackage{trimspaces}
\makeatletter
\newcommand{\newcommenter}[3]{%
  \ifdraft
    \newcommand{#1}[1]{%
      \begingroup\small\sffamily\color{#2}%
        [#3: \trim@spaces{##1}]%
      \endgroup%
    }%
  \else
    \newcommand{#1}[1]{\ignorespaces}
  \fi
}
\makeatother
\definecolor{darkgreen}{rgb}{0,0.7,0}

\newcommenter{\ethan}{darkgreen}{Ethan}
\newcommenter{\akh}{purple}{AKH}

\newcommand{\todo}[1]{\bgroup\small\sffamily\color{red}[\textbf{Todo:} #1]\egroup}

%% === Program Syntax ===
\newcounter{numlevels}
\NewDocumentCommand{\newMLP}{sO{l}mO{0}om}{
  \IfBooleanTF{#1}{
    \IfValueTF{#5}{
      \WithSuffix\newcommand#3*[#4][#5]
    }{
      \WithSuffix\newcommand#3*[#4]
    }
  }{
    \IfValueTF{#5}{
      \newcommand{#3}[#4][#5]
    }{
      \newcommand{#3}[#4]
    }
  }
  {\ifthenelse{\value{numlevels} > 0}{\begin{array}[t]{@{}#2@{}}}{\begin{array}{#2}}\addtocounter{numlevels}{1}#6\addtocounter{numlevels}{-1}\end{array}}
}
\makeatletter
\def\def@block@inner#1#2#3\_nil{#1 & #2\ifx\relax#3\relax\else \\ \def@block@inner#3\_nil\fi}%
\newcommand{\typeset@def@block}[2]{\begin{array}[t]{@{}l@{{}#1{}}l@{}}\def@block@inner#2\_nil\end{array}}
\makeatother

\newcommand{\ty}{\mkern2mu{:}\mkern2mu}
\newcommand{\proves}{\vdash}
\newcommand{\nproves}{\nvdash}
\newcommand{\dom}[1]{\operatorname{dom}({#1})}
\newcommand{\seq}{\mathrel{;}}
\newcommand{\sendsto}{\rightsquigarrow}

\definecolor{chorcolor}{HTML}{0053A9}
\definecolor{localcolor}{HTML}{007C21}
\definecolor{ntwkcolor}{HTML}{E44223}
\definecolor{choicecolor}{HTML}{BB7A00}
\definecolor{loccolor}{HTML}{b51963}
\newcommand{\LocalCol}[1]{{\color{localcolor}#1}}

\newcommand{\programfont}[1]{\ensuremath{\mathsf{#1}}\xspace}
\newcommand{\LocalLangFont}[1]{\programfont{\LocalCol{#1}}}
\newcommand{\LocFont}[1]{\programfont{\color{loccolor}#1}}

\newcommand{\Mngr}{\LocFont{M}}
\newcommand{\Client}{\LocFont{C}}
\newcommand{\Alice}{\LocFont{A}}
\newcommand{\Bob}{\LocFont{B}}
\newcommand{\Cathy}{\LocFont{C}}
\newcommand{\Dave}{\LocFont{D}}

%% Choreographic Syntax
\newcommand{\ChorCol}[1]{{\color{chorcolor}#1}}
\newcommand{\ChorFont}[1]{\programfont{\ChorCol{#1}}}

\newcommand{\ChorDef}{\mathrel{\ChorCol{\coloneqq}}}
\newcommand{\ColSend}{\mathrel{\ChorCol{\sendsto}}}

\newcommand{\multircv}[1][n]{\mathrel{\mathchoice%
  {\mathord{\sendsto}\mkern-2mu\raisebox{0.125ex}{$\scriptstyle[#1]$}}
  {\mathord{\sendsto}\mkern-2mu\raisebox{0.125ex}{$\scriptstyle[#1]$}}
  {\mathord{\sendsto}\mkern-1mu\raisebox{0.1ex}{$\scriptstyle[#1]$}\mkern3mu}
  {\mathord{\sendsto}\mkern-1mu\raisebox{0.05ex}{$\scriptstyle[#1]$}\mkern3mu}%
}}
%\newcommand{\multircv}[1]{\mathrel{\overset{#1}{\sendsto}}}

\newcommand{\IfN}{\ChorFont{if}}
\newcommand{\Then}{\ChorFont{then}}
\newcommand{\Else}{\ChorFont{else}}
\newcommand{\ForkN}{\ChorFont{fork}}
\newcommand{\LetN}{\ChorFont{let}}
\newcommand{\In}{\ChorFont{in}}
\newcommand{\FunN}{\ChorFont{fun}}
\newcommand{\LamN}{\ChorCol{\lambda}}
\newcommand{\TLamN}{\ChorCol{\Lambda}}

\newcommand{\ForkIn}[3]{{#1}.\ForkN２苌铪３茴鬻吞歇芷矧肷铨鄢蓰１芷矧胛２苘苌铪３茴鬻泔眄犷潲芴弭深裔鼾鄄蓰芴弭牺１苌铪２茴鬻吞歇垓利l]{\LetInRaw}[2]{\LetN & {#1} \\ \In & {#2}}
\newcommand{\LetIn}[3]{\LetInRaw{{#1} \ChorDef {#2}}{#3}}
\WithSuffix\newcommand\LetIn*[3]{\LetInRaw*{{#1} \ChorDef {#2}}{#3}}
\makeatletter
\newMLP{\LetMany}[2]{\LetN  {\typeset@def@block{\ChorDef}{#1}} \\ \In  {#2}}
\makeatother
\newcommand{\Fun}[3]{\operatorname{\FunN}{#1}({#2}) \ChorDef {#3}}
\newMLP*{\Fun}[3]{\operatorname{\FunN}{#1}({#2}) \ChorDef \\ {#3}}
\newcommand{\ITE}[3]{\IfN１茉桢铪２芘祗妣３茴鬻吞歇苌耘鄢蓰苌嫖１苘茉桢铪２苘芘祗妣３ゥ五赭矧御铘狲茴鬻泔眄犷潲芪赭朊镬郾蓰茔镬矧铘麟泔祜螨１茴鬻泔眄犷潲芪赭肫镱酏郾蓰苠铙躜屙狒棼茼狒梏酐芪赭朊镬１茗箴徙妪茴鬻泔眄犷潲芰砩轭锡芪赭肫镱酐另绍磲翳矧潲荛铨茴鬻泔眄犷潲芰砩轭鄢蓰苠铙躜屙狒棼茱疱蜥麸蝾犴妍芰砩轭锡１茼狒桠轭芪赭肫镱酐魁２茼狒桠轭芪赭肫镱酐糊３茴鬻泔眄犷潲芰砩锡芪赭肫镱酐另升茴鬻泔眄犷潲芰砩鄢蓰苠铙躜屙狒棼茱疱蜥麸蝾犴妍芰砩锡１茼狒桠轭芪赭肫镱酐魁２茼狒桠轭芪赭肫镱酐糊３浇硝綮轭篝蝓泗躜浇荃箦疳汶徵妍怙邃黹铋疳珏茼犭遽綮弭翦茴鬻泔躅翦螓秕綮轭謇翦眇灬翦腻痿椠茴鬻泔躅翦螓秕綮轭謇溴痿椠茴鬻孱鲩蝻铐孱酐秕綮轭妪鄄蒇拜茴鬻扉篝祧忑孱蹴弪狒妪洱荏弭扉篝垤鲮蓰疳蝮屦桨吵茆狍屐轭弩腴瓞轸屙箦鸾梆衄麸痼屦桨痿戾骠磲蜱轭奖靛睚荏弭扉篝垤鲮陛戾骠磲蜱轭姜麸痼屦桨靛睚荏弭泔躅翦螓秕綮轭謇翦眇灬翦腻痿椠１荏弭泔躅翦螓秕綮轭謇溴痿椠饼芾麒殪孱蹴荟犰蹂秕綮轭謇翦眇灬翦腻痿椠级茕稃荛驺狍遘鲠祯妍秕綮轭謇翦眇灬翦腻痿椠茯屐狲荏弭扉篝垤鲮荟犰蹂秕綮轭謇溴痿椠蓰灬忮旖芤镯犷茱荏弭扉篝垤鲮荟犰蹂秕綮轭謇溴痿椠蓰灬忮旖芰祓瑾茱荏弭扉篝垤鲮荟犰蹂秕綮轭謇溴痿椠蓰灬忮旖茚蜥忾悛茱荏弭扉篝垤鲮荟犰蹂秕綮轭謇溴痿椠蓰灬忮旖茚祓瑾茱荏弭扉篝垤鲮荟犰蹂秕綮轭謇溴痿椠蓰灬忮旖茯镯犷茱荏弭扉篝垤鲮荟犰蹂秕綮轭謇溴痿椠蓰灬忮旖苕荏翦疸秕铘弪秕綮轭謇溴痿椠荏翦疸秕铘弪秕綮轭謇翦眇灬翦腻痿椠荛孳蝈灬茕弭镫孱辁妍２茯屐狲苠祗莛狎茴镩钿孱酐茆骟弪殄２莛狎苕茴镩钿孱籁茆彗轭祧忑苠钿祧忑荟箴徙妍爱驳屙茴鬻孱鲩蝻铐孱酐怙邃秕綮轭妪鄄蒇拜茆彗轭怙邃黹铋疳珏荇屮赭殇翳茆彗轭秕綮轭妪郏陛２苠钿秕綮轭妪苠钿怙邃黹铋疳珏荟箴徙妍爱靛睚莛狎茼犭遽麸翳弪ゥ田汜轴蜷徕戾蠛ゥ盹溴灬翦ゥ藻丨磲篝弪溴筱ゥ蓬浜